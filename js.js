function n(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=Array(t);e<t;e++)r[e]=n[e];return r}function t(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e,r,o=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=o){var a=[],i=!0,c=!1;try{for(o=o.call(n);!(i=(e=o.next()).done)&&(a.push(e.value),!t||a.length!==t);i=!0);}catch(n){c=!0,r=n}finally{try{i||null==o.return||o.return()}finally{if(c)throw r}}return a}}(n,t)||r(n,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(t)||r(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}}var o=performance.now(),a=!1,i=[],c=document.currentScript.outerHTML,l=document.body.innerHTML.replace(c,""),u="사과\n바나나\n포도\n딸기\n오렌지\n체리\n복숭아\n수박\n파인애플\n배\n레몬\n라즈베리\n블루베리\n키위\n망고\n참외\n아보카도\n석류\n자몽\n두리안\n코코넛\n라임\n자두\n무화과\n감\n살구\n상추\n양파\n당근\n감자\n토마토\n오이\n시금치\n호박\n콩\n옥수수\n파프리카\n브로콜리\n고구마\n아스파라거스\n샐러리\n양배추\n고추\n버섯\n마늘\n생강\n비트\n콜라비\n아티초크\n미역\n김\n호박\n피망\n죽순\n무\n고사리\n갓\n청경채\n케일\n취나물\n치커리\n미나리\n더덕\n토란\n귤\n대추\n파파야\n복분자\n유자\n부추\n매실\n호두\n가지\n노각".split("\n"),s=performance.now();(function n(){if(a)throw Error("This function should not be called more than once.");a=!0;var r=t(e("각".normalize("NFD")),3),c=r[0],d=r[1],f=r[2],m=12623-d.charCodeAt(0),h=Object.fromEntries(Object.entries({ㄱㄱ:"ㄲ",ㄱㅅ:"ㄳ",ㄴㅈ:"ㄵ",ㄴㅎ:"ㄶ",ㄷㄷ:"ㄸ",ㄹㄱ:"ㄺ",ㄹㅁ:"ㄻ",ㄹㅂ:"ㄼ",ㄹㅅ:"ㄽ",ㄹㅌ:"ㄾ",ㄹㅍ:"ㄿ",ㄹㅎ:"ㅀ",ㅂㅂ:"ㅃ",ㅂㅅ:"ㅄ",ㅅㅅ:"ㅆ",ㅈㅈ:"ㅉ",ㅏㅣ:"ㅐ",ㅑㅣ:"ㅒ",ㅓㅣ:"ㅔ",ㅕㅣ:"ㅖ",ㅗㅏ:"ㅘ",ㅗㅐ:"ㅙ",ㅗㅣ:"ㅚ",ㅜㅓ:"ㅝ",ㅜㅔ:"ㅞ",ㅜㅣ:"ㅟ",ㅡㅣ:"ㅢ"}).map(function(n){var e=t(n,2),r=e[0];return[e[1],r]})),g=e(u);function p(n){return e(n.normalize("NFC")).flatMap(S)}for(var v=[],y=0;y<16;y++)v.push.apply(v,e(g.splice(O(0,g.length-1),1)));var b=document.getElementById("word-list"),M=document.getElementById("word-template");v.forEach(function(n){var t=M.content.cloneNode(!0);t.querySelector("li").textContent=n,b.appendChild(t)});var w=document.getElementById("jamo-board"),j=document.getElementById("jamo-template");w.addEventListener("selectstart",function(n){n.preventDefault()});var E="ㄱㄴㄷㄹㅁㅂㅅㅇㅈㅊㅋㅌㅍㅎㅏㅑㅓㅕㅗㅛㅜㅠㅡㅣ";function S(n){var r=t(e(n.normalize("NFD")).concat(["","",""]).slice(0,3),3),o=r[0],a=r[1],i=r[2];return["ㄱㄲㄴㄷㄸㄹㅁㅂㅃㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎ"[o.charCodeAt(0)-c.charCodeAt(0)],String.fromCharCode(a.charCodeAt(0)+m),i.length?"ㄱㄲㄳㄴㄵㄶㄷㄹㄺㄻㄼㄽㄾㄿㅀㅁㅂㅄㅅㅆㅇㅈㅊㅋㅌㅍㅎ"[i.charCodeAt(0)-f.charCodeAt(0)]:""].flatMap(function(n){var t;return e(null!==(t=h[n])&&void 0!==t?t:n)})}window.composeIntoComposite=function(n){n=e(n);for(var r={cho:{ㄱ:["ㄱ","jung"],ㄴㄹㅁㅇㅊㅋㅌㅍㅎ:["jung"],ㄷ:["ㄷ","jung"],ㅂ:["ㅂ","jung"],ㅅ:["ㅅ","jung"],ㅈ:["ㅈ","jung"]},jung:{ㅏㅑㅓㅕㅡ:["ㅣ","jong"],ㅗ:["ㅏ","ㅣ","jong"],ㅛㅠㅣ:["jong"],ㅜ:["ㅓ","ㅣ","jong"]},jong:{ㄱ:["ㄱ","ㅅ","cho"],ㄴ:["ㅈ","ㅎ","cho"],ㄷㅁㅇㅈㅊㅋㅌㅍㅎ:["cho"],ㄹ:["ㄱ","ㅁ","ㅂ","ㅅ","ㅌ","ㅍ","ㅎ","cho"],ㅂ:["ㅅ","cho"],ㅅ:["ㅅ","cho"]}},o={cho:2,jung:3,jong:2},a={cho:0,jung:0,jong:0},i="cho",c=[],l=[],u=null;n[0];)!function(){var s=n.shift();l.push(s),a[i]++;var d=Object.entries(r[i]).find(function(n){var e=t(n,2),r=e[0];return e[1],r.includes(s)});if(!d)throw Error("cannot find suitable continuation for jamo sequence");var f=t(d,2),m=(f[0],f[1]);if(1===m.length||a[i]===o[i]){if(a[i]=0,i=m[0],c.push(e(l)),l.length=0,u&&!u.includes(s))throw Error("next candidate mismatch");u=null}else u=m.slice(0,-1)}();return c};var A=null;function C(n,t){t.classList.add("notransition"),n(),requestAnimationFrame(function(){requestAnimationFrame(function(){t.classList.remove("notransition")})})}w.style.setProperty("--gap","".concat(.75,"em")),w.style.setProperty("--width",12),w.style.setProperty("--height",12),C(function(){for(var n=0;n<144;n++){var t=j.content.cloneNode(!0).querySelector("i"),r=O(0,1)?E[O(0,E.length-1)]:(null===A&&(A=v.flatMap(function(n){return e(n.normalize("NFC")).flatMap(S)})),A[O(0,A.length-1)]);t.textContent=r,w.appendChild(t)}},w);var L=Array.from({length:144},function(){return null}),P=function(n,t,e,r){switch(e){case 0:return[n+r,t];case 1:return[n+r,t-r];case 2:return[n,t-r];case 3:return[n-r,t-r];case 4:return[n-r,t];case 5:return[n-r,t+r];case 6:return[n,t+r];case 7:return[n+r,t+r];default:throw RangeError("invalid direction")}},I=w.querySelectorAll("#jamo-board>i");I.forEach(function(n,t){n.dataset.index=t});var x=function(n,e,r,o){var a,i=p(n);if(i.length>12&&i.length>12)throw RangeError("word too long for board");for(var c=0;c<i.length;c++){var l=t(P(e,r,o,c),2),u=l[0],s=l[1];if(u<0||u>=12||s<0||s>=12)return!1;var d=L[12*s+u];if(d&&d!==i[c])return!1}for(var f=0;f<i.length;f++){var m,h,g,v,y,b,M=t(P(e,r,o,f),2),j=M[0],E=M[1];0===f&&(m=(y=[j,E])[0],h=y[1]),f===i.length-1&&(g=(b=[j,E])[0],v=b[1]);var S=i[f],A=12*E+j;L[A]=S,I[A].textContent=S}return a=q(m,h,g,v),w.appendChild(a),!0};function q(n,t,e,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=function n(t,e){var r,o=null!==(r=n.cache)&&void 0!==r?r:n.cache=new Map;if(o.has(t))return o.get(t);var a=e();return o.set(t,a),a}(q,function(){return document.getElementById("completion-bar-template")}),i=null!=o?o:a.content.cloneNode(!0).querySelector(".completion-bar"),c=Math.min(n,e),l=Math.max(n,e),u=Math.min(t,r),s=Math.max(t,r),d=(l-c+1)*2+.75*(l-c),f=(s-u+1)*2+.75*(s-u);return i.style.setProperty("--top","".concat(2*u+.75*u,"em")),i.style.setProperty("--left","".concat(2*c+.75*c,"em")),i.style.setProperty("--width","".concat(d,"em")),i.style.setProperty("--height","".concat(f,"em")),i.style.setProperty("--thick","".concat(2.25,"em")),i.style.setProperty("--hypot","".concat(Math.hypot(d,f)+.25,"em")),i.style.setProperty("--angle","".concat(180*Math.atan2(Math.sign(r-t)*f,Math.sign(e-n)*d)/Math.PI,"deg")),i.style.setProperty("--color","oklch(75% 75% ".concat(k+Math.floor(43758.5453*Math.sin(12.9898*n+78.233*t)%1*T)*Math.floor(360/T),"deg)")),i}function O(n,t){return Math.floor(Math.random()*(t-n+1))+n}w.style.setProperty("--size","".concat(2,"rem")),v.sort(function(n,t){return p(t).length-p(n).length});var T=16,k=O(0,359),F=Array.from({length:4},function(){return 16}),N=64,z=function(){for(var n=O(0,N-1),t=0,e=0;e<4;e++)if(n<(t+=F[e]))return e};try{v.forEach(function(n){for(var t,e,r,o=0;;){t=O(0,11),e=O(0,11);var a=((r=z())+6)%8;if(x(n,t,e,a)){F[r]--,N--,16-F[r]>16/3&&(N-=F[r],F[r]=0);break}if(o>256)throw"The board generation was stuck in impossible state, so the page was reloaded.";o++}})}catch(t){console.error(t),i.forEach(clearInterval),i.length=0,e(document.body.children).filter(function(n){return n!==document.currentScript}).forEach(function(n){return n.remove()}),document.body.innerHTML=l,a=!1,n();return}var B=document.getElementById("dark-mode-toggle");B.addEventListener("click",function(){var n,t=B.dataset.mode,e=B.dataset.modeOptions.split("|"),r=e[(e.indexOf(t)+1)%e.length];n=function(){B.dataset.mode=r,document.documentElement.dataset.mode=r},document.startViewTransition?document.startViewTransition(n):n(),localStorage.darkMode=r});var D=localStorage.darkMode;D&&C(function(){B.dataset.mode=D,document.documentElement.dataset.mode=D},B);var H=new Proxy({value:!1},{set:function(n,t,e){if("value"===t&&"boolean"==typeof e)return e?(console.log("pointerdown"),Array.from(w.querySelectorAll(".start, .mid, .end")).forEach(function(n){return n.classList.remove("start","mid","end")})):console.log("pointerup"),Reflect.set(n,t,e)}}),J=[-1,-1],R=-1,G=[-1,-1];function V(n){return[n%12,Math.floor(n/12)]}var X=null;function Y(){if(-1!==J[0]&&-1!==J[1]){var n=null!==X,e=t(J,2),r=e[0],o=e[1],a=t(-1===G[0]&&-1===G[1]?[r,o]:G,2);X=q(r,o,a[0],a[1],X),n||w.appendChild(X)}}w.addEventListener("pointerdown",function(n){H.value=!0;var t=document.elementFromPoint(n.clientX,n.clientY);t.matches("#jamo-board>i")&&(t.classList.add("start"),J=V(1*t.dataset.index),G=[-1,-1],R=-1,Y())}),document.addEventListener("pointerup",function(n){H.value=!1,-1!==G[0]&&-1!==G[1]&&(J[0]!==G[0]||J[1]!==G[1])&&function(){throw"TODO"}()}),document.addEventListener("pointermove",function(n){if(H.value){var e=document.elementFromPoint(n.clientX,n.clientY);if(null==e?void 0:e.matches("#jamo-board>i")){var r=V(1*e.dataset.index);if(J[0]===r[0]&&J[1]===r[1])return;null===(C=w.querySelector(".mid"))||void 0===C||C.classList.remove("mid"),e.classList.add("mid");var o=function(n,e){var r=t(n,2),o=r[0],a=r[1],i=t(e,2),c=i[0],l=i[1];if(!(o===c||a===l||Math.abs(o-c)===Math.abs(a-l)))return -1;var u=[c-o,l-a],s=u[0];return[[3,2,1],[4,-1,0],[5,6,7]][Math.sign(u[1])+1][Math.sign(s)+1]}(J,r);if(-1!==o?(G=r,R=o):-1!==G[0]&&-1!==G[1]&&(a=J,i=R,l=(c=t(a,2))[0],u=c[1],h=(m=[(d=(s=t(r,2))[0])-l,(f=s[1])-u])[0],g=m[1],v=(p=[d-l,f-u])[0],y=p[1],M=(b=[d-l,f-u])[0],Math.abs(v)<Math.abs(y)?v=0:y=0,(M+(j=b[1]))%2&&(Math.abs(M)<Math.abs(j)?j-=Math.sign(j):M-=Math.sign(M)),E=Math.abs(Math.abs(M)-Math.abs(j))/2,Math.abs(M)<Math.abs(j)?(M+=Math.sign(M)*E,j-=Math.sign(j)*E):(M-=Math.sign(M)*E,j+=Math.sign(j)*E),G=(S=Math.abs(h-v)+Math.abs(g-y))===(A=Math.abs(h-M)+Math.abs(g-j))?i%2==0?[l+v,u+y]:[l+M,u+j]:S<A?[l+v,u+y]:[l+M,u+j]),-1!==G[0]&&-1!==G[1]){var a,i,c,l,u,s,d,f,m,h,g,p,v,y,b,M,j,E,S,A,C,L,P=I[12*G[1]+G[0]];null===(L=w.querySelector(".end"))||void 0===L||L.classList.remove("end"),P.classList.add("end"),Y()}}}}),window.serializeGameState=function(){var n=e(document.querySelectorAll("#word-list>li")).map(function(n){return n.textContent}).join(","),t=Array.from({length:144},function(n,t){return I[t].textContent}).join(""),r="".concat(n,"|").concat(12,"|").concat(12,"|").concat(t),o=e(r).map(function(n){return n.charCodeAt()}).reduce(function(n,t){return(n>>>1|(1&n)<<15)^t},0);return"".concat(r,"|").concat(o)};var U=performance.now();requestIdleCallback(function(){var n,t,e=performance.now(),r=o-begin,a=s-o,i=U-s,c=e-U,l=e-begin;console.log("Document parsed in","".concat(r," ms")),console.log("JS parsed in","".concat(a," ms")),console.log("Game initialized in","".concat(i," ms")),console.log("Fully interactive(idle) in","".concat(c," ms")),console.log("Total time from beginning","".concat(l," ms"));var u=(n=[],"string"==typeof(t=localStorage.perfHistory)?JSON.parse(t):null!=n?n:null);u.push([r,a,i,c,l]),localStorage.perfHistory=JSON.stringify(u)})})(),window.addEventListener("load",function(){console.log("page loaded: ".concat(performance.now()-begin,"ms"))});
