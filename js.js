function t(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function n(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e,r,o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var a=[],i=!0,c=!1;try{for(o=o.call(t);!(i=(e=o.next()).done)&&(a.push(e.value),!n||a.length!==n);i=!0);}catch(t){c=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(c)throw r}}return a}}(t,n)||r(t,n)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(n){return function(n){if(Array.isArray(n))return t(n)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||r(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n,e){if(n){if("string"==typeof n)return t(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if("Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(n,e)}}performance.now();var o=!1,a=[],i=document.currentScript.outerHTML,c=document.body.innerHTML.replace(i,""),l="사과\n바나나\n포도\n딸기\n오렌지\n체리\n복숭아\n수박\n파인애플\n배\n레몬\n라즈베리\n블루베리\n키위\n망고\n참외\n아보카도\n석류\n자몽\n두리안\n코코넛\n라임\n자두\n무화과\n감\n살구\n상추\n양파\n당근\n감자\n토마토\n오이\n시금치\n호박\n콩\n옥수수\n파프리카\n브로콜리\n고구마\n아스파라거스\n샐러리\n양배추\n고추\n버섯\n마늘\n생강\n비트\n콜라비\n아티초크\n미역\n김\n호박\n피망\n죽순\n무\n고사리\n갓\n청경채\n케일\n취나물\n치커리\n미나리\n더덕\n토란\n귤\n대추\n파파야\n복분자\n유자\n부추\n매실\n호두\n가지\n노각".split("\n");function u(){if(o)throw Error("This function should not be called more than once.");o=!0;var t=[[3,2,1],[4,-1,0],[5,6,7]],r=n(e("각".normalize("NFD")),3),a=r[0],i=r[1],c=r[2],u=12623-i.charCodeAt(0),h=Object.fromEntries(Object.entries({ㄱㄱ:"ㄲ",ㄱㅅ:"ㄳ",ㄴㅈ:"ㄵ",ㄴㅎ:"ㄶ",ㄷㄷ:"ㄸ",ㄹㄱ:"ㄺ",ㄹㅁ:"ㄻ",ㄹㅂ:"ㄼ",ㄹㅅ:"ㄽ",ㄹㅌ:"ㄾ",ㄹㅍ:"ㄿ",ㄹㅎ:"ㅀ",ㅂㅂ:"ㅃ",ㅂㅅ:"ㅄ",ㅅㅅ:"ㅆ",ㅈㅈ:"ㅉ",ㅏㅣ:"ㅐ",ㅑㅣ:"ㅒ",ㅓㅣ:"ㅔ",ㅕㅣ:"ㅖ",ㅗㅏ:"ㅘ",ㅗㅏㅣ:"ㅙ",ㅗㅣ:"ㅚ",ㅜㅓ:"ㅝ",ㅜㅓㅣ:"ㅞ",ㅜㅣ:"ㅟ",ㅡㅣ:"ㅢ"}).map(function(t){var e=n(t,2),r=e[0];return[e[1],r]})),v=-1;try{(M=function(t){if(null===t)return null;var e=n(t.split("|"),8),r=e[0],o=e[1],a=e[2],i=e[3],c=e[4],l=e[5],u=e[6],s=e[7];if(1*r!=2)throw Error("The saved game state is from a different version of the game.");if(L("".concat(r,"|").concat(o,"|").concat(a,"|").concat(i,"|").concat(c,"|").concat(l,"|").concat(u))!==1*s||c.length!==a*i)throw Error("saved game state is corrupted");return[o.split(","),1*a,1*i,c,l?l.split(",").map(Number).reduce(function(t,n){return t.length&&4!==t.at(-1).length||t.push([]),t.at(-1).push(n),t},[]):[],1*u]}(d("gameState")))&&(v=M[5])}catch(t){console.error(t),f("gameState")}var y=e(l);function g(t){return e(t.normalize("NFC")).flatMap(j)}var p=M?M[0]:[];if(!M){for(var M,b=0;b<16;b++)p.push.apply(p,e(y.splice(J(0,y.length-1),1)));y.length=0}var w=document.getElementById("word-list"),S=document.getElementById("word-template");p.forEach(function(t){var n=S.content.cloneNode(!0).querySelector("li");n.textContent=t,n.dataset.word=t,w.appendChild(n)});var E=document.getElementById("jamo-board"),A=document.getElementById("jamo-template");E.addEventListener("selectstart",function(t){t.preventDefault()});var C=!1;E.addEventListener("contextmenu",function(t){C||t.preventDefault(),C=!1});var x="ㄱㄴㄷㄹㅁㅂㅅㅇㅈㅊㅋㅌㅍㅎㅏㅑㅓㅕㅗㅛㅜㅠㅡㅣ";function L(t){return e(t).map(function(t){return t.charCodeAt()}).reduce(function(t,n){return(t>>>1|(1&t)<<15)^n},0)}function P(){var t=p.join(),n=Array.from({length:144},function(t,n){return N[n].textContent}).join(""),e=Array.from(E.querySelectorAll(".completion-bar")).filter(function(t){return t!==te}).map(function(t){return"".concat(t.dataset.start,",").concat(t.dataset.end)}).join(),r="".concat(2,"|").concat(t,"|").concat(12,"|").concat(12,"|").concat(n,"|").concat(e,"|").concat(v);return"".concat(r,"|").concat(L(r))}function j(t){var r=n(e(t.normalize("NFD")).concat(["","",""]).slice(0,3),3),o=r[0],i=r[1],l=r[2];return["ㄱㄲㄴㄷㄸㄹㅁㅂㅃㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎ"[o.charCodeAt(0)-a.charCodeAt(0)],String.fromCharCode(i.charCodeAt(0)+u),l.length?"ㄱㄲㄳㄴㄵㄶㄷㄹㄺㄻㄼㄽㄾㄿㅀㅁㅂㅄㅅㅆㅇㅈㅊㅋㅌㅍㅎ"[l.charCodeAt(0)-c.charCodeAt(0)]:""].flatMap(function(t){var n;return e(null!==(n=h[t])&&void 0!==n?n:t)})}var z=p.flatMap(function(t){return e(t.normalize("NFC")).flatMap(j)});function I(t,n){n.classList.add("notransition"),t(),requestAnimationFrame(function(){requestAnimationFrame(function(){n.classList.remove("notransition")})})}E.style.setProperty("--gap","".concat(.75,"em")),E.style.setProperty("--width",12),E.style.setProperty("--height",12),I(function(){for(var t=0;t<144;t++){var n=A.content.cloneNode(!0).querySelector("i"),e=M?M[3][t]:J(0,1)?x[J(0,x.length-1)]:z[J(0,z.length-1)];n.textContent=e,E.appendChild(n)}},E);var q=Array.from({length:144},function(){return null}),B=function(n,e,r,o){if(r<0||r>7)throw RangeError("direction must be 0 to 7");for(var a=-1;a<=1;a++)for(var i=-1;i<=1;i++)if(t[a+1][i+1]===r)return[n+i*o,e+a*o]},N=E.querySelectorAll("#jamo-board>i");N.forEach(function(t,n){t.dataset.index=n});var k=function(t,e,r,o){var a=g(t);if(a.length>12&&a.length>12)throw RangeError("word too long for board");for(var i=0;i<a.length;i++){var c=n(B(e,r,o,i),2),l=c[0],u=c[1];if(l<0||l>=12||u<0||u>=12)return!1;var s=q[12*u+l];if(s&&s!==a[i])return!1}for(var d=0;d<a.length;d++){var f,m,h=n(B(e,r,o,d),2),v=h[0],y=h[1];0===d&&((f=[v,y])[0],f[1]),d===a.length-1&&((m=[v,y])[0],m[1]);var p=a[d],M=12*y+v;q[M]=p,N[M].textContent=p}return!0};function T(t,n){var e,r=null!==(e=T.cache)&&void 0!==e?e:T.cache=new Map;if(r.has(t))return r.get(t);var o=n();return r.set(t,o),o}function F(t,n,e,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=T(F,function(){return document.getElementById("completion-bar-template")}),i=null!=o?o:a.content.cloneNode(!0).querySelector(".completion-bar");i.dataset.start="".concat(t,",").concat(n),i.dataset.end="".concat(e,",").concat(r);var c=Math.sign(r-n),l=Math.min(t,e),u=Math.max(t,e),s=Math.min(n,r),d=Math.max(n,r),f=(u-l+1)*2+.75*(u-l),m=(d-s+1)*2+.75*(d-s);i.style.setProperty("--top","".concat(2*s+.75*s,"em")),i.style.setProperty("--left","".concat(2*l+.75*l,"em")),i.style.setProperty("--width","".concat(f,"em")),i.style.setProperty("--height","".concat(m,"em")),i.style.setProperty("--thick","".concat(2.25,"em")),i.style.setProperty("--hypot","".concat(Math.hypot(f,m)+.25,"em")),i.style.setProperty("--angle","".concat(180*Math.atan2(c*m,Math.sign(e-t)*f)/Math.PI,"deg"));var h=Math.floor(43758.5453*Math.sin(12.9898*t+78.233*n)%1*X)*Math.floor(360/X),y="oklch(75% 75% ".concat(v+h,"deg)");return i.style.setProperty("--color",y),i}E.style.setProperty("--size","".concat(2,"rem"));var O=0,R=document.getElementById("stage-clear-dialog"),D=R.querySelector("#next-stage"),H=R.querySelector("#cancel-next-stage");function V(t,n){O++,t.style.setProperty("--color",n.style.getPropertyValue("--color")),t.classList.add("found"),16===O&&R.showModal()}function J(t,n){return Math.floor(Math.random()*(n-t+1))+t}D.addEventListener("click",function(){f("gameState"),s()}),H.addEventListener("click",function(){R.close()});var X=16;M||(v=J(0,359));var Y=Array.from({length:4},function(){return 16}),G=64,U=function(){for(var t=J(0,G-1),n=0,e=0;e<4;e++)if(t<(n+=Y[e]))return e};if(M)M[4].forEach(function(t){var e,r,o=n(t,4),a=o[0],i=o[1],c=o[2],l=o[3];e=F(a,i,c,l),r=ti(ta(a,i,c,l)),V(w.querySelector('li[data-word="'.concat(r,'"]')),e),E.appendChild(e)});else try{p.toSorted(function(t,n){return g(n).length-g(t).length}).forEach(function(t){for(var n,e,r,o=0;;){n=J(0,11),e=J(0,11);var a=((r=U())+6)%8;if(k(t,n,e,a)){Y[r]--,G--,16-Y[r]>16/3&&(G-=Y[r],Y[r]=0);break}if(o>256)throw"The board generation was stuck in impossible state, so the page was reloaded.";o++}})}catch(t){console.error(t),s();return}var W=document.getElementById("dark-mode-toggle");W.addEventListener("click",function(){var t,n=W.dataset.mode,e=W.dataset.modeOptions.split("|"),r=e[(e.indexOf(n)+1)%e.length];t=function(){W.dataset.mode=r,document.documentElement.dataset.mode=r},document.startViewTransition?document.startViewTransition(t):t(),localStorage.darkMode=r});var $=localStorage.darkMode;$&&I(function(){W.dataset.mode=$,document.documentElement.dataset.mode=$},W);var K=new Proxy({value:!1},{set:function(t,n,e){if("value"===n&&"boolean"==typeof e)return Reflect.set(t,n,e)}}),Q=[-1,-1],Z=-1,_=[-1,-1];function tt(t){return[t%12,Math.floor(t/12)]}function tn(e,r){var o=n(e,2),a=o[0],i=o[1],c=n(r,2),l=c[0],u=c[1];if(!(a===l||i===u||Math.abs(a-l)===Math.abs(i-u)))return -1;var s=[l-a,u-i],d=s[0];return t[Math.sign(s[1])+1][Math.sign(d)+1]}var te=null;function tr(){if(-1!==Q[0]&&-1!==Q[1]){var t=null!==te,e=n(Q,2),r=e[0],o=e[1],a=n(-1===_[0]&&-1===_[1]?[r,o]:_,2);te=F(r,o,a[0],a[1],te),t||E.appendChild(te)}}function to(t,n){for(var e=t<n?1:-1,r=[],o=0;o<=Math.abs(n-t);o+=1)r.push(o*e+t);return r}function ta(t,e,r,o){var a=to(t,r),i=to(e,o);return Array.from({length:Math.max(a.length,i.length)},function(n,r){var o,c;return[null!==(o=a[r])&&void 0!==o?o:t,null!==(c=i[r])&&void 0!==c?c:e]}).map(function(t){var e=n(t,2),r=e[0];return N[12*e[1]+r].textContent}).join("")}function ti(t){return p.find(function(e){var r=n(T(e,function(){var t=g(e);return[t.join(""),t.toReversed().join("")]}),2),o=r[0],a=r[1];return o===t||a===t})}function tc(t,n,e){return t<n?n-t:t>e?t-e:0}E.addEventListener("pointerdown",function(t){var n=document.elementFromPoint(t.clientX,t.clientY);n.matches("#jamo-board>i")&&(K.value=!0,Q=tt(1*n.dataset.index),_=[-1,-1],Z=-1,tr())}),document.addEventListener("pointerup",function(t){C=2===t.button,K.value=!1,-1!==_[0]&&-1!==_[1]&&(Q[0]!==_[0]||Q[1]!==_[1])&&function(t){try{if(null===t)return;var e=n(t.dataset.start.split(",").map(Number),2),r=e[0],o=e[1],a=n(t.dataset.end.split(",").map(Number),2),i=a[0],c=a[1];if(r===i&&o===c){t.remove();return}var l=tn([r,o],[i,c]);if(-1===l){t.remove();return}var u=ta(r,o,i,c),s=ti(u);if(s){var d=w.querySelector('li[data-word="'.concat(s,'"]'));d&&(d.classList.contains("found")?t.remove():V(d,t))}else t.remove()}finally{te=null}}(te)}),document.addEventListener("pointermove",function(t){if(K.value){t.preventDefault();var e=document.elementFromPoint(t.clientX,t.clientY);if(null==e?void 0:e.matches("#jamo-board>i")){var r=tt(1*e.dataset.index);if(Q[0]===r[0]&&Q[1]===r[1])return;var o=tn(Q,r);if(-1!==o)_=r,Z=o;else if(-1!==_[0]&&-1!==_[1]){var a=n((l=Q,u=Z,d=(s=n(l,2))[0],f=s[1],g=(y=[(h=(m=n(r,2))[0])-d,(v=m[1])-f])[0],p=y[1],b=(M=[h-d,v-f])[0],w=M[1],E=(S=[h-d,v-f])[0],Math.abs(b)<Math.abs(w)?b=0:w=0,(E+(A=S[1]))%2&&(Math.abs(E)<Math.abs(A)?A-=Math.sign(A):E-=Math.sign(E)),C=Math.abs(Math.abs(E)-Math.abs(A))/2,Math.abs(E)<Math.abs(A)?(E+=Math.sign(E)*C,A-=Math.sign(A)*C):(E-=Math.sign(E)*C,A+=Math.sign(A)*C),(x=Math.abs(g-b)+Math.abs(p-w))===(L=Math.abs(g-E)+Math.abs(p-A))?u%2==0?[d+b,f+w]:[d+E,f+A]:x<L?[d+b,f+w]:[d+E,f+A]),2),i=a[0],c=a[1];if(i<0||i>=12||c<0||c>=12){var l,u,s,d,f,m,h,v,y,g,p,M,b,w,S,E,A,C,x,L,P,j=tn(Q,[i,c]),z=tc(i,0,11),I=tc(c,0,11);i=(P=n(B(i,c,j,-Math.max(z,I)),2))[0],c=P[1]}_=[i,c]}-1!==_[0]&&-1!==_[1]&&(N[12*_[1]+_[0]],tr())}}}),M||m("gameState",P()),window.serializeGameState=P;var tl=document.querySelector("main"),tu=function(){var t=screen.availWidth,n=screen.availHeight;w.style.zoom=1,w.style.fontSize="1rem",E.style.zoom=1,tl.style.zoom=1;var e=w.getBoundingClientRect().width,r=E.getBoundingClientRect().width;w.style.zoom=Math.min(1,t/e),w.style.fontSize="".concat(1/w.style.zoom,"rem"),E.style.zoom=Math.min(1,t/r);var o=tl.getBoundingClientRect().height;tl.style.zoom=Math.min(1,n/o)};tu(),window.addEventListener("resize",tu),window.addEventListener("beforeunload",function(){d("gameState")&&m("gameState",P())}),performance.now()}function s(){a.forEach(clearInterval),a.length=0,e(document.body.children).filter(function(t){return t!==document.currentScript}).forEach(function(t){return t.remove()}),document.body.innerHTML=c,o=!1,u()}function d(t,n){var e=localStorage[t];return"string"==typeof e?JSON.parse(e):null!=n?n:null}function f(t){delete localStorage[t]}function m(t,n){localStorage[t]=JSON.stringify(n)}performance.now(),u(),document.getElementById("show-settings-panel").addEventListener("click",function(){document.getElementById("settings-panel").showModal()});

//# sourceMappingURL=js.js.map