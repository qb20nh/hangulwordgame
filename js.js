function t(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function n(t,n,e,r,o,a,i){try{var c=t[a](i),l=c.value}catch(t){e(t);return}c.done?n(l):Promise.resolve(l).then(r,o)}function e(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e,r,o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var a=[],i=!0,c=!1;try{for(o=o.call(t);!(i=(e=o.next()).done)&&(a.push(e.value),!n||a.length!==n);i=!0);}catch(t){c=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(c)throw r}}return a}}(t,n)||o(t,n)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n){return function(n){if(Array.isArray(n))return t(n)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||o(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(n,e){if(n){if("string"==typeof n)return t(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if("Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(n,e)}}performance.now(),window.toSingleNumber=function(t,n){return(t>=n?n:t+n+1)+Math.pow(Math.max(t,n),2)};var a,i,c,l,u,s,f,d,h=document.currentScript.outerHTML,m=document.body.innerHTML.replace(h,""),v="사과\n바나나\n포도\n딸기\n오렌지\n체리\n복숭아\n수박\n파인애플\n배\n레몬\n라즈베리\n블루베리\n키위\n망고\n참외\n아보카도\n석류\n자몽\n두리안\n코코넛\n라임\n자두\n무화과\n감\n살구\n상추\n양파\n당근\n감자\n토마토\n오이\n시금치\n호박\n콩\n옥수수\n파프리카\n브로콜리\n고구마\n아스파라거스\n샐러리\n양배추\n고추\n버섯\n마늘\n생강\n비트\n콜라비\n아티초크\n미역\n김\n호박\n피망\n죽순\n무\n고사리\n갓\n청경채\n케일\n취나물\n치커리\n미나리\n더덕\n토란\n귤\n대추\n파파야\n복분자\n유자\n부추\n매실\n호두\n가지\n노각".split("\n");function p(){if(window.hwgInitialized)throw Error("Game was already initialized.");window.hwgInitialized=!0;var t=[[3,2,1],[4,-1,0],[5,6,7]],n=e(r("각".normalize("NFD")),3),o=n[0],l=n[1],u=n[2],s=12623-l.charCodeAt(0),f=Object.fromEntries(Object.entries({ㄱㄱ:"ㄲ",ㄱㅅ:"ㄳ",ㄴㅈ:"ㄵ",ㄴㅎ:"ㄶ",ㄷㄷ:"ㄸ",ㄹㄱ:"ㄺ",ㄹㅁ:"ㄻ",ㄹㅂ:"ㄼ",ㄹㅅ:"ㄽ",ㄹㅌ:"ㄾ",ㄹㅍ:"ㄿ",ㄹㅎ:"ㅀ",ㅂㅂ:"ㅃ",ㅂㅅ:"ㅄ",ㅅㅅ:"ㅆ",ㅈㅈ:"ㅉ",ㅏㅣ:"ㅐ",ㅑㅣ:"ㅒ",ㅓㅣ:"ㅔ",ㅕㅣ:"ㅖ",ㅗㅏ:"ㅘ",ㅗㅏㅣ:"ㅙ",ㅗㅣ:"ㅚ",ㅜㅓ:"ㅝ",ㅜㅓㅣ:"ㅞ",ㅜㅣ:"ㅟ",ㅡㅣ:"ㅢ"}).map(function(t){var n=e(t,2),r=n[0];return[n[1],r]})),d=-1;try{(b=function(t){if(null===t)return null;var n=e(t.split("|"),8),r=n[0],o=n[1],a=n[2],i=n[3],c=n[4],l=n[5],u=n[6],s=n[7];if(1*r!=3)throw Error("The saved game state is from a different version of the game.");if(P("".concat(r,"|").concat(o,"|").concat(a,"|").concat(i,"|").concat(c,"|").concat(l,"|").concat(u))!==1*s||c.length!==a*i)throw Error("saved game state is corrupted");return[o.split(","),1*a,1*i,c,l?l.split(",").map(Number).reduce(function(t,n){return t.length&&4!==t.at(-1).length||t.push([]),t.at(-1).push(n),t},[]):[],1*u]}(g("gameState")))&&(d=b[5])}catch(t){console.error(t),delete a.gameState}var h=r(v);function m(t){return r(t.normalize("NFC")).flatMap(x)}var p=b?b[0]:[];if(!b){for(var b,M=0;M<16;M++)p.push.apply(p,r(h.splice(V(0,h.length-1),1)));h.length=0}var E=document.getElementById("word-list"),S=document.getElementById("word-template");p.forEach(function(t){var n=S.content.cloneNode(!0).querySelector("li");n.textContent=t,n.dataset.word=t,E.appendChild(n)});var A=document.getElementById("jamo-board"),C=document.getElementById("jamo-template");A.addEventListener("selectstart",function(t){t.preventDefault()});var L=!1;A.addEventListener("contextmenu",function(t){L||t.preventDefault(),L=!1});var j="ㄱㄴㄷㄹㅁㅂㅅㅇㅈㅊㅋㅌㅍㅎㅏㅑㅓㅕㅗㅛㅜㅠㅡㅣ";function P(t){return r(t).map(function(t){return t.charCodeAt()}).reduce(function(t,n){return(t>>>1|(1&t)<<15)^n},0)}function k(){var t=p.join(),n=Array.from({length:144},function(t,n){return R[n].dataset.jamo}).join(""),e=Array.from(A.querySelectorAll(".completion-bar")).filter(function(t){return t!==te}).map(function(t){return"".concat(t.dataset.start,",").concat(t.dataset.end)}).join(),r="".concat(3,"|").concat(t,"|").concat(12,"|").concat(12,"|").concat(n,"|").concat(e,"|").concat(d);return"".concat(r,"|").concat(P(r))}function x(t){var n=e(r(t.normalize("NFD")).concat(["","",""]).slice(0,3),3),a=n[0],i=n[1],c=n[2];return["ㄱㄲㄴㄷㄸㄹㅁㅂㅃㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎ"[a.charCodeAt(0)-o.charCodeAt(0)],String.fromCharCode(i.charCodeAt(0)+s),c.length?"ㄱㄲㄳㄴㄵㄶㄷㄹㄺㄻㄼㄽㄾㄿㅀㅁㅂㅄㅅㅆㅇㅈㅊㅋㅌㅍㅎ"[c.charCodeAt(0)-u.charCodeAt(0)]:""].flatMap(function(t){var n;return r(null!==(n=f[t])&&void 0!==n?n:t)})}var z=p.flatMap(function(t){return r(t.normalize("NFC")).flatMap(x)});function I(t,n){n.classList.add("no-transition"),t(),i(function(){i(function(){n.classList.remove("no-transition")})})}A.style.setProperty("--gap","".concat(.75,"em")),A.style.setProperty("--width",12),A.style.setProperty("--height",12),I(function(){for(var t=0;t<144;t++){var n=C.content.cloneNode(!0).querySelector("i"),e=b?b[3][t]:V(0,1)?j[V(0,j.length-1)]:z[V(0,z.length-1)];n.dataset.jamo=e,A.appendChild(n)}},A);var B=Array.from({length:144},function(){return null}),N=function(n,e,r,o){if(r<0||r>7)throw RangeError("direction must be 0 to 7");for(var a=-1;a<=1;a++)for(var i=-1;i<=1;i++)if(t[a+1][i+1]===r)return[n+i*o,e+a*o]},R=A.querySelectorAll("#jamo-board>i");R.forEach(function(t,n){t.dataset.index=n});var T=function(t,n,r,o){var a=m(t);if(a.length>12&&a.length>12)throw RangeError("word too long for board");for(var i=0;i<a.length;i++){var c=e(N(n,r,o,i),2),l=c[0],u=c[1];if(l<0||l>=12||u<0||u>=12)return!1;var s=B[12*u+l];if(s&&s!==a[i])return!1}for(var f=0;f<a.length;f++){var d=e(N(n,r,o,f),2),h=d[0],v=d[1],p=a[f],y=12*v+h;B[y]=p,R[y].dataset.jamo=p}return!0};function q(t,n){var e,r=null!==(e=q.cache)&&void 0!==e?e:q.cache=new Map;if(r.has(t))return r.get(t);var o=n();return r.set(t,o),o}function O(t,n,e,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=q(O,function(){return document.getElementById("completion-bar-template")}),i=null!=o?o:a.content.cloneNode(!0).querySelector(".completion-bar");i.dataset.start="".concat(t,",").concat(n),i.dataset.end="".concat(e,",").concat(r);var c=Math.sign(r-n),l=Math.min(t,e),u=Math.max(t,e),s=Math.min(n,r),f=Math.max(n,r),h=(u-l+1)*2+.75*(u-l),m=(f-s+1)*2+.75*(f-s);i.style.setProperty("--top","".concat(2*s+.75*s,"em")),i.style.setProperty("--left","".concat(2*l+.75*l,"em")),i.style.setProperty("--width","".concat(h,"em")),i.style.setProperty("--height","".concat(m,"em")),i.style.setProperty("--thick","".concat(2.25,"em")),i.style.setProperty("--hypot","".concat(Math.hypot(h,m)+.25,"em")),i.style.setProperty("--angle","".concat(180*Math.atan2(c*m,Math.sign(e-t)*h)/Math.PI,"deg"));var v=Math.floor(43758.5453*Math.sin(12.9898*t+78.233*n)%1*J)*Math.floor(360/J),p="oklch(75% 75% ".concat(d+v,"deg)");return i.style.setProperty("--color",p),i}A.style.setProperty("--size","".concat(2,"rem"));var D=0,F=document.getElementById("stage-clear-dialog"),G=F.querySelector("#next-stage"),H=F.querySelector("#cancel-next-stage");function U(t,n){D++,t.style.setProperty("--color",n.style.getPropertyValue("--color")),t.classList.add("found"),16===D&&F.showModal()}function V(t,n){return Math.floor(Math.random()*(n-t+1))+t}G.addEventListener("click",function(){delete a.gameState,y()},{passive:!0}),H.addEventListener("click",function(){F.close()},{passive:!0});var J=16;b||(d=V(0,359));var X=Array.from({length:4},function(){return 16}),Y=64,W=function(){for(var t=V(0,Y-1),n=0,e=0;e<4;e++)if(t<(n+=X[e]))return e};if(b)b[4].forEach(function(t){var n,r,o=e(t,4),a=o[0],i=o[1],c=o[2],l=o[3];n=O(a,i,c,l),r=ti(ta(a,i,c,l)),U(E.querySelector('li[data-word="'.concat(r,'"]')),n),A.appendChild(n)});else try{p.toSorted(function(t,n){return m(n).length-m(t).length}).forEach(function(t){for(var n,e,r,o=0;;){n=V(0,11),e=V(0,11);var a=((r=W())+6)%8;if(T(t,n,e,a)){X[r]--,Y--,16-X[r]>16/3&&(Y-=X[r],X[r]=0);break}if(o>256)throw Error("The board generation was stuck in impossible state, so the page was reloaded.");o++}})}catch(t){console.error(t),y();return}var $=document.getElementById("dark-mode-toggle");$.addEventListener("click",function(){var t,n=$.dataset.mode,e=$.dataset.modeOptions.split("|"),r=e[(e.indexOf(n)+1)%e.length];t=function(){$.dataset.mode=r,document.documentElement.dataset.mode=r},document.startViewTransition?document.startViewTransition(t):t(),a.darkMode=r},{passive:!0});var K=a.darkMode;K&&I(function(){$.dataset.mode=K,document.documentElement.dataset.mode=K},$);var Q=new Proxy({value:!1},{set:function(t,n,e){if("value"===n&&"boolean"==typeof e)return Reflect.set(t,n,e)}}),Z=[-1,-1],_=-1,tt=[-1,-1];function tn(n,r){var o=e(n,2),a=o[0],i=o[1],c=e(r,2),l=c[0],u=c[1];if(!(a===l||i===u||Math.abs(a-l)===Math.abs(i-u)))return -1;var s=[l-a,u-i],f=s[0];return t[Math.sign(s[1])+1][Math.sign(f)+1]}var te=null;function tr(){if(-1!==Z[0]&&-1!==Z[1]){var t=null!==te,n=e(Z,2),r=n[0],o=n[1],a=e(-1===tt[0]&&-1===tt[1]?[r,o]:tt,2);te=O(r,o,a[0],a[1],te),t||A.appendChild(te)}}function to(t,n){for(var e=t<n?1:-1,r=[],o=0;o<=Math.abs(n-t);o++)r.push(o*e+t);return r}function ta(t,n,r,o){var a=to(t,r),i=to(n,o);return Array.from({length:Math.max(a.length,i.length)},function(e,r){var o,c;return[null!==(o=a[r])&&void 0!==o?o:t,null!==(c=i[r])&&void 0!==c?c:n]}).map(function(t){var n=e(t,2),r=n[0];return R[12*n[1]+r].dataset.jamo}).join("")}function ti(t){return p.find(function(n){var r=e(q(n,function(){var t=m(n);return[t.join(""),t.toReversed().join("")]}),2),o=r[0],a=r[1];return o===t||a===t})}function tc(t,n,e){return t<n?n-t:t>e?t-e:0}function tl(t,n){var r,o,a,i,c,l,u,s,f=e((r=R[0],o=R[1],a=R[12],i=r.getBoundingClientRect(),c=o.getBoundingClientRect(),l=a.getBoundingClientRect(),u=c.left-i.left,s=l.top-i.top,[i.left,i.top,u,s,c.left-i.right,l.top-i.bottom]),6),d=f[0],h=f[1],m=f[2],v=f[3],p=[t-(d-f[4]/2),n-(h-f[5]/2)],y=[Math.floor(p[0]/m),Math.floor(p[1]/v)];return[y[0],y[1]]}function tu(t,n,e){return Math.min(e,Math.max(n,t))}A.addEventListener("pointerdown",function(t){t.target.matches("#jamo-board>i")&&(Q.value=!0,Z=tl(t.clientX,t.clientY),tt=[-1,-1],_=-1,tr())},{passive:!0}),document.addEventListener("pointerup",function(t){L=2===t.button,Q.value=!1,-1!==tt[0]&&-1!==tt[1]&&(Z[0]!==tt[0]||Z[1]!==tt[1])&&function(t){try{if(null===t)return;var n=e(t.dataset.start.split(",").map(Number),2),r=n[0],o=n[1],a=e(t.dataset.end.split(",").map(Number),2),i=a[0],c=a[1];if(r===i&&o===c){t.remove();return}var l=tn([r,o],[i,c]);if(-1===l){t.remove();return}var u=ta(r,o,i,c),s=ti(u);if(s){var f=E.querySelector('li[data-word="'.concat(s,'"]'));f&&(f.classList.contains("found")?t.remove():U(f,t))}else t.remove()}finally{te=null}}(te)},{passive:!0}),document.addEventListener("pointermove",function(t){if(Q.value){t.preventDefault();var n=tl(t.clientX,t.clientY);if(n[0]=tu(n[0],0,11),n[1]=tu(n[1],0,11),Z[0]!==n[0]||Z[1]!==n[1]){var r=tn(Z,n);if(-1!==r?(tt=n,_=r):-1!==tt[0]&&-1!==tt[1]&&(c=Z,l=_,s=(u=e(c,2))[0],f=u[1],p=(v=[(h=(d=e(n,2))[0])-s,(m=d[1])-f])[0],y=v[1],w=(g=[h-s,m-f])[0],b=g[1],E=(M=[h-s,m-f])[0],Math.abs(w)<Math.abs(b)?w=0:b=0,(E+(S=M[1]))%2&&(Math.abs(E)<Math.abs(S)?S-=Math.sign(S):E-=Math.sign(E)),A=Math.abs(Math.abs(E)-Math.abs(S))/2,Math.abs(E)<Math.abs(S)?(E+=Math.sign(E)*A,S-=Math.sign(S)*A):(E-=Math.sign(E)*A,S+=Math.sign(S)*A),tt=(C=Math.abs(p-w)+Math.abs(y-b))===(L=Math.abs(p-E)+Math.abs(y-S))?l%2==0?[s+w,f+b]:[s+E,f+S]:C<L?[s+w,f+b]:[s+E,f+S]),-1!==tt[0]&&-1!==tt[1]){var o=e(tt,2),a=o[0],i=o[1];if(a<0||a>=12||i<0||i>=12){var c,l,u,s,f,d,h,m,v,p,y,g,w,b,M,E,S,A,C,L,j,P=tn(Z,[a,i]),k=tc(a,0,11),x=tc(i,0,11);a=(j=e(N(a,i,P,-Math.max(k,x)),2))[0],i=j[1]}R[12*(tt=[a,i])[1]+tt[0]],tr()}}}}),b||w("gameState",k()),window.serializeGameState=k;var ts=function(){var t=c.availWidth;E.style.zoom=1,E.style.fontSize="1rem",A.style.setProperty("--zoom",1);var n=E.getBoundingClientRect().width,e=A.getBoundingClientRect().width;E.style.zoom=Math.min(1,t/n),E.style.fontSize="".concat(1/E.style.zoom,"rem"),A.style.setProperty("--zoom",Math.min(1,t/e))};ts(),window.addEventListener("resize",ts),window.addEventListener("beforeunload",function(){g("gameState")&&w("gameState",k())}),performance.now()}function y(){r(document.body.children).filter(function(t){return t!==document.currentScript}).forEach(function(t){return t.remove()}),document.body.innerHTML=m,window.hwgInitialized=!1,p()}function g(t,n){var e=a[t];return"string"==typeof e?JSON.parse(e):null!=n?n:null}function w(t,n){a[t]=JSON.stringify(n)}window.average=function(t){return t.reduce(function(t,n){return t+n},0)/t.length},window.median=function(t){var n=t.slice().sort(function(t,n){return t-n}),e=Math.floor(n.length/2);return n.length%2==0?(n[e-1]+n[e])/2:n[e]},window.getCurrentFunctionName=function(){return Error().stack.split("\n").slice(1)[1].match(/at (\w+)/)[1]},performance.now(),p(),l=["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a","Enter"],u=0,s=function(t){return function(t,n){var e,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(e)throw TypeError("Generator is already executing.");for(;i;)try{if(e=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(t,i)}catch(t){a=[6,t],r=0}finally{e=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,function(n){return t.key===l[u]?++u===l.length&&(console.log("showing lunatic text"),window.removeEventListener("keydown",d)):u=0,[2]})},f=function(){var t=this,e=arguments;return new Promise(function(r,o){var a=s.apply(t,e);function i(t){n(a,r,o,i,c,"next",t)}function c(t){n(a,r,o,i,c,"throw",t)}i(void 0)})},d=function(t){return f.apply(this,arguments)},window.addEventListener("keydown",d,{passive:!0}),document.getElementById("show-settings-panel").addEventListener("click",function(){document.getElementById("settings-panel").showModal()});

//# sourceMappingURL=js.js.map